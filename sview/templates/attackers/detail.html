{%- from "_snippets.html" import await_job with context -%}
{%- from "_snippets.html" import data_box with context -%}
{%- from "_snippets.html" import pair_data_box with context -%}
{%- from "_snippets.html" import map_box with context -%}
{%- from "_snippets.html" import line_box with context -%}
{%- from "_snippets.html" import country_code_item with context -%}
{% extends "layout.html" %}
{% block body %}
<h1 class="display-4">{{ ip }}</h1>
{% call await_job(job_id) %}
	<div class="row">
		<div class="col-lg-12 pb-3" align="center">
			{{ line_box("attacker_activity", "Attacker activity", data.attacker_activity, "day", "count", "Events") }}
		</div>
	</div>
	{% if data.attacker_passwords %}
	<div class="row">
		<div class="col-lg-12 pb-3" align="center">
			{% call(data_item) data_box("Attacker's passwords", data.attacker_passwords, "password") %}
				<a href="{{ url_for("passwords.password_details", encoded_password=data_item|b64) }}">
					{{ data_item }}
				</a>
			{% endcall %}
		</div>
	</div>
	{% endif %}
{% endcall %}
{% endblock %}
